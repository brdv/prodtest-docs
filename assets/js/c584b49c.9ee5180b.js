"use strict";(self.webpackChunkprodtest=self.webpackChunkprodtest||[]).push([[806],{3905:(e,t,r)=>{r.d(t,{Zo:()=>d,kt:()=>u});var n=r(7294);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var l=n.createContext({}),c=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},d=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,i=e.mdxType,a=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),h=c(r),u=i,m=h["".concat(l,".").concat(u)]||h[u]||p[u]||a;return r?n.createElement(m,o(o({ref:t},d),{},{components:r})):n.createElement(m,o({ref:t},d))}));function u(e,t){var r=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=r.length,o=new Array(a);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var c=2;c<a;c++)o[c]=r[c];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},6255:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var n=r(7462),i=(r(7294),r(3905));const a={title:"OrderService",sidebar_position:2,slug:"order-service"},o=void 0,s={unversionedId:"demo/technical-detail/order-service",id:"demo/technical-detail/order-service",title:"OrderService",description:"The OrderService is the first service that will be called by the proxy on incoming requests. This page describes how the service is designed and implemented.",source:"@site/docs/demo/technical-detail/order-service.md",sourceDirName:"demo/technical-detail",slug:"/demo/technical-detail/order-service",permalink:"/prodtest-docs/demo/technical-detail/order-service",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"OrderService",sidebar_position:2,slug:"order-service"},sidebar:"tutorialSidebar",previous:{title:"Technical detail",permalink:"/prodtest-docs/demo/technical-detail/"},next:{title:"Examples",permalink:"/prodtest-docs/category/examples"}},l={},c=[{value:"Architecture",id:"architecture",level:2},{value:"Flow",id:"flow",level:2},{value:"Implementation",id:"implementation",level:2},{value:"Dependencies",id:"dependencies",level:3},{value:"Development Choices",id:"development-choices",level:2}],d={toc:c};function p(e){let{components:t,...a}=e;return(0,i.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"The OrderService is the first service that will be called by the proxy on incoming requests. This page describes how the service is designed and implemented."),(0,i.kt)("h2",{id:"architecture"},"Architecture"),(0,i.kt)("p",null,"The order service is built as a REST API and consists of three main layers (note: there is no database used in this service): the controller, service and the message queue."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"architecture schematic",src:r(3373).Z,width:"1572",height:"1288"})),(0,i.kt)("p",null,"The controller is responsible for receiving and validating requests. The service handles the request, i.e. performs any needed business logic and prepares a response to be returned by the controller. The message queue is used to store messages which other services can consume.\nIn case the request is invalid, e.g. invalid data in POST request body, the server will respond with an error (in case of invalid data: validation error)."),(0,i.kt)("p",null,"This pattern has been chosen for two primary reasons: testablity and separation of concerns. It separates communication (request, response) and business logic (handler) from each other, thereby decoupling separate concerns within the application. This separation also makes it easier to test individual functionality (methods) independently from each other. (More about testing later)."),(0,i.kt)("h2",{id:"flow"},"Flow"),(0,i.kt)("p",null,"The image below shows an example of a possible flow in the service. (Description below image)."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Swim lane",src:r(8681).Z,width:"1400",height:"1430"})),(0,i.kt)("p",null,"As you can see above, each class/layer is responsible for its own piece of the flow. The controller receives the initital requests and validates them. This means that it checks if it is a proper CreateOrderRequest model. If not, it will return a bad request error to the client. Otherwise, it will pass the request to the OrderService.\nThe order service (class) handles the business logic of the order. This means it will create an OrderModel object of the request, make sure it will be published by the RabbitMQService on the queue and return the OrderModel to the controller which in turn will send it as response to the client."),(0,i.kt)("h2",{id:"implementation"},"Implementation"),(0,i.kt)("p",null,"Below you can see an overview of the implemented classes to realise the OrderService."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"class diagram",src:r(1469).Z,width:"1792",height:"1776"})),(0,i.kt)("p",null,"Note: all classes marked with an asterix (","*",") can be found in the Domain.Commons project. They are not directly part of the OrderService, but it does depend on them."),(0,i.kt)("h3",{id:"dependencies"},"Dependencies"),(0,i.kt)("p",null,"In the class diagram above you see two services; the (I)OrderService and the (I)RabbitMQService. These services are created and passed by using ",(0,i.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-7.0"},"dependency injection"),". An example of how this is implemented can be found below."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Dependency Injection",src:r(7194).Z,width:"1942",height:"876"})),(0,i.kt)("h2",{id:"development-choices"},"Development Choices"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Context"),(0,i.kt)("th",{parentName:"tr",align:null},"Options"),(0,i.kt)("th",{parentName:"tr",align:null},"Choice"),(0,i.kt)("th",{parentName:"tr",align:null},"Rationale"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"In order to receive and allocate requests within the cluster, we need to choose a proxy"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"https://traefik.io"},"Traefik"),", ",(0,i.kt)("a",{parentName:"td",href:"https://www.nginx.com/"},"NginX"),", ",(0,i.kt)("a",{parentName:"td",href:"https://www.envoyproxy.io/"},"Envoy")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"Traefik")),(0,i.kt)("td",{parentName:"tr",align:null},"Very ",(0,i.kt)("a",{parentName:"td",href:"https://doc.traefik.io/traefik/routing/services/#mirroring-service"},"well documented")," data mirroring option + good kubernetes integrations.")))))}p.isMDXComponent=!0},7194:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/di-example-754aa993bc61307a15c13c767d104e90.png"},3373:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/order-service-architecture-layers-c2464e72f3f2d449c501ba0524f36777.png"},1469:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/order-service-class-diagram-148b938e000f6e2527cf666d3686f489.png"},8681:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/order-service-swim-lane-1da81722ef80cf3eac673aeac59e384b.png"}}]);