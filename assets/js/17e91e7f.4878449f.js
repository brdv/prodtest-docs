"use strict";(self.webpackChunkprodtest=self.webpackChunkprodtest||[]).push([[279],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>p});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=a.createContext({}),c=function(e){var t=a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),h=c(r),p=n,k=h["".concat(l,".").concat(p)]||h[p]||d[p]||o;return r?a.createElement(k,i(i({ref:t},u),{},{components:r})):a.createElement(k,i({ref:t},u))}));function p(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var c=2;c<o;c++)i[c]=r[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}h.displayName="MDXCreateElement"},6496:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var a=r(7462),n=(r(7294),r(3905));const o={title:"Dark Launch",sidebar_position:1},i="Dark launch",s={unversionedId:"tip-basics/dark-launch",id:"tip-basics/dark-launch",title:"Dark Launch",description:"This page describes a dark launch, also known as shadow release, dark mirror release or dark traffic test but at prodtest we call it a dark launch. A dark launch is a deployment or testing stategy for testing a newer version of a service or piece of software. The main goal of a dark launch is to mirror (a subset of) incoming production traffic to the new service but discarding the response. This allows you to monitor the funcitonality and performance of the service while under a real-world production load without taking the risk of exposing your users to it.",source:"@site/docs/tip-basics/dark-launch.md",sourceDirName:"tip-basics",slug:"/tip-basics/dark-launch",permalink:"/prodtest-docs/tip-basics/dark-launch",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Dark Launch",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Testing in production",permalink:"/prodtest-docs/category/testing-in-production"},next:{title:"Demo project",permalink:"/prodtest-docs/demo/"}},l={},c=[{value:"What is a dark launch",id:"what-is-a-dark-launch",level:2},{value:"Why would I dark launch",id:"why-would-i-dark-launch",level:2},{value:"How to dark launch",id:"how-to-dark-launch",level:2},{value:"Proxy",id:"proxy",level:3},{value:"Risks of dark launch",id:"risks-of-dark-launch",level:2},{value:"Data separation",id:"data-separation",level:3},{value:"Example of a dark launch",id:"example-of-a-dark-launch",level:2}],u={toc:c};function d(e){let{components:t,...o}=e;return(0,n.kt)("wrapper",(0,a.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"dark-launch"},"Dark launch"),(0,n.kt)("p",null,"This page describes a dark launch, also known as shadow release, dark mirror release or dark traffic test but at prodtest we call it a dark launch. A dark launch is a deployment or testing stategy for testing a newer version of a service or piece of software. The main goal of a dark launch is to mirror (a subset of) incoming production traffic to the new service but discarding the response. This allows you to monitor the funcitonality and performance of the service while under a real-world production load without taking the risk of exposing your users to it."),(0,n.kt)("p",null,"This guide will talk about dark launches more in depth and will show you how you could implement a dark launch."),(0,n.kt)("h2",{id:"what-is-a-dark-launch"},"What is a dark launch"),(0,n.kt)("p",null,"As mentioned in the top section, a dark launch means that your will deploy two versions of the same service or software. Let's call them Vcurrent (released version) and Vnext (new version). When both versions are deployed you have to mirror (a part of) the incoming requests to Vnext. Mirroring means that somehow (we'll get to that later) you have to send requests to both Vcurrent and Vnext - the mirroring - while letting the user interact solely with Vcurrent. The traffic that is mirrored to Vnext will not result in a response to the user. The basic interaction will look like this:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Dark Launch basic",src:r(9962).Z,width:"695",height:"376"})),(0,n.kt)("p",null,"Note that a more elaborate scheme is depicted in ",(0,n.kt)("a",{parentName:"p",href:"#how-to-dark-launch"},"How to dark launch"),"."),(0,n.kt)("h2",{id:"why-would-i-dark-launch"},"Why would I dark launch"),(0,n.kt)("p",null,"Let's say that you have upgraded an important piece of a service that has to do with an expected response time improvement. You want to test the service to see if the expected speed improvement will actually occur. Because you don't know if the improvement is stable yet, you want to test the service without exposing it to end-users. By implementing a dark launch you can directly test your new service with actual real-world production traffic that is generated by users. Since the response from Vnext is discarded, the end-user will not know about the processing that happens in Vnext."),(0,n.kt)("h2",{id:"how-to-dark-launch"},"How to dark launch"),(0,n.kt)("p",null,"There are two main ways to do a dark launch, both with their own use case."),(0,n.kt)("p",null,"The first use case is dark launching a service that is accessed by a proxy. Since all requests go through the proxy, we can use that proxy to mirror requests to the Vnext instance. Note that the proxy must support a mirroring options, two examples that do are ",(0,n.kt)("a",{parentName:"p",href:"https://nginx.org/en/docs/http/ngx_http_mirror_module.html"},"NGINX")," and ",(0,n.kt)("a",{parentName:"p",href:"https://doc.traefik.io/traefik/routing/services/#mirroring-service"},"Traefik"),"."),(0,n.kt)("p",null,"Another use case is when you want to dark launch a service that is not accessed through a proxy but has an internal connection. ",(0,n.kt)("strong",{parentName:"p"},(0,n.kt)("em",{parentName:"strong"},"This use case will be explored in a later iteration."))),(0,n.kt)("h3",{id:"proxy"},"Proxy"),(0,n.kt)("p",null,"A proxy - or proxyserver - is a server application that sits in between a client and a resource and that acts as an intermediary. The benefits of a proxy is that the client does not have to have a direct connection to the resource but can request a resource by the proxy. The proxy in turn passes the request to the resource and returns the response. This intermediary can allow you to make a copy of (a percentage of) all incoming requests and send that copy to a newer version of the resource. Both resources can log relevant information that in turn can be sent to a monitoring service. This would look as follows:"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Dark Launch proxy concept",src:r(625).Z,width:"954",height:"318"})),(0,n.kt)("p",null,"*"," the response of Vnext will be discarded by the proxy. Only the response of Vcurrent will be sent back."),(0,n.kt)("h2",{id:"risks-of-dark-launch"},"Risks of dark launch"),(0,n.kt)("p",null,"Since the goal of a dark launch it to test a new or updated service in a production environment under production load ",(0,n.kt)("strong",{parentName:"p"},"without")," exposing it to end users, the risks of a dark launch are relatively small. However there are a few things to keep in mind when implementing a dark launch."),(0,n.kt)("h3",{id:"data-separation"},"Data separation"),(0,n.kt)("p",null,"Since you are testing a new feature in a production envorinment using production data (from the mirrored requests), you have to be very careful nog to save the responses from the new feature or service to the production database that ",(0,n.kt)("strong",{parentName:"p"},"is")," exposed to end users. How you can separate the test and production data in the production environment will be elaborated in a future iteration."),(0,n.kt)("h2",{id:"example-of-a-dark-launch"},"Example of a dark launch"),(0,n.kt)("p",null,"You can find examples of a dark launch in the ",(0,n.kt)("a",{parentName:"p",href:"/demo"},"demo project"),"."))}d.isMDXComponent=!0},9962:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/dark-launch-basic-1af450db78e248670e12a0d44c81a5e4.png"},625:(e,t,r)=>{r.d(t,{Z:()=>a});const a=r.p+"assets/images/dark-launch-concept-proxy-0e595d882b95da54d80fdf7dc3da2547.png"}}]);